{
	"Version": "2019-10-30",
	"StartAction": "87859db2-400d-410b-8818-05c8ae4869aa",
	"Metadata": {
		"entryPointPosition": {
			"x": -1670.4,
			"y": 229.6
		},
		"ActionMetadata": {
			"Payment Success": {
				"position": {
					"x": 6239.2,
					"y": -44.8
				},
				"isFriendlyName": true
			},
			"Record Transaction ID": {
				"position": {
					"x": 5782.4,
					"y": -149.6
				},
				"isFriendlyName": true,
				"dynamicParams": []
			},
			"Speak Amount": {
				"position": {
					"x": -960.8,
					"y": 145.6
				},
				"isFriendlyName": true
			},
			"Amount Choice Timeout": {
				"position": {
					"x": -682.4,
					"y": -324.8
				},
				"isFriendlyName": true
			},
			"Speak Minimum Payment": {
				"position": {
					"x": -170.4,
					"y": -35.2
				},
				"isFriendlyName": true
			},
			"Payment Amount Timeout": {
				"position": {
					"x": -153.6,
					"y": -653.6
				},
				"isFriendlyName": true
			},
			"Payment Too Large": {
				"position": {
					"x": 138.4,
					"y": -688.8
				},
				"isFriendlyName": true
			},
			"Payment Too Small": {
				"position": {
					"x": 378.4,
					"y": -691.2
				},
				"isFriendlyName": true
			},
			"Check Payment Amount": {
				"position": {
					"x": 9.6,
					"y": -431.2
				},
				"isFriendlyName": true,
				"conditions": [],
				"conditionMetadata": [
					{
						"id": "37771bc4-1dec-41ba-a080-7620b065b108",
						"operator": {
							"name": "Equals",
							"value": "Equals",
							"shortDisplay": "="
						},
						"value": "Timeout"
					},
					{
						"id": "8f9b74ec-9df9-4c9d-828e-434df165996c",
						"operator": {
							"name": "Is greater than",
							"value": "GreaterThan",
							"shortDisplay": ">"
						},
						"value": "$.Attributes.PaymentAmountDue"
					},
					{
						"id": "70aee05f-8b26-4a59-b1b2-0c835810a114",
						"operator": {
							"name": "Is less than",
							"value": "LessThan",
							"shortDisplay": "<"
						},
						"value": "$.Attributes.PaymentMinimumPayment"
					}
				]
			},
			"87859db2-400d-410b-8818-05c8ae4869aa": {
				"position": {
					"x": -1628.8,
					"y": 480
				}
			},
			"a3ea896e-4f43-4677-8edd-159f677dc41e": {
				"position": {
					"x": 7818.4,
					"y": 192.8
				}
			},
			"Check for Customer Email": {
				"position": {
					"x": 6460.8,
					"y": -43.2
				},
				"isFriendlyName": true,
				"conditions": [],
				"conditionMetadata": [
					{
						"id": "dffc6c69-ebc0-4afe-941b-ce5b6f6888ff",
						"operator": {
							"name": "Contains",
							"value": "Contains",
							"shortDisplay": "contains"
						},
						"value": "@"
					}
				]
			},
			"Use Payment Method Again Timeout": {
				"position": {
					"x": 1083.2,
					"y": -928.8
				},
				"isFriendlyName": true
			},
			"Payment Method Timeout": {
				"position": {
					"x": 2208,
					"y": -267.2
				},
				"isFriendlyName": true
			},
			"Use Bank Account Again?": {
				"position": {
					"x": 1353.6,
					"y": -356.8
				},
				"isFriendlyName": true,
				"conditionMetadata": [
					{
						"id": "c544359b-87a3-4436-86ff-3b6c42191e24",
						"value": "1"
					},
					{
						"id": "46349057-9e0d-4ae6-be9d-b1f911e84201",
						"value": "2"
					}
				]
			},
			"Check for Minimum Payment": {
				"position": {
					"x": -723.2,
					"y": 153.6
				},
				"isFriendlyName": true,
				"conditions": [],
				"conditionMetadata": [
					{
						"id": "1218fdb3-3ba1-41ac-9044-e6ed6afbd70e",
						"operator": {
							"name": "Equals",
							"value": "Equals",
							"shortDisplay": "="
						},
						"value": "PaymentAmountDue"
					},
					{
						"id": "d83cdaff-fb8f-4dc2-9425-d9c29c503ff2",
						"operator": {
							"name": "Is greater than",
							"value": "GreaterThan",
							"shortDisplay": ">"
						},
						"value": "0"
					}
				]
			},
			"Check for Payment Token": {
				"position": {
					"x": 1096,
					"y": -18.4
				},
				"isFriendlyName": true,
				"conditions": [],
				"conditionMetadata": [
					{
						"id": "28c82332-f1c7-4bf3-91c0-6ed48b3ff4f6",
						"operator": {
							"name": "Starts with",
							"value": "StartsWith",
							"shortDisplay": "starts with"
						},
						"value": "VC"
					},
					{
						"id": "b5e67f16-cffc-4433-a0e1-f0128771e148",
						"operator": {
							"name": "Starts with",
							"value": "StartsWith",
							"shortDisplay": "starts with"
						},
						"value": "BC"
					},
					{
						"id": "64fce1d8-dd59-4b4a-80e7-ad01dfe7ad29",
						"operator": {
							"name": "Starts with",
							"value": "StartsWith",
							"shortDisplay": "starts with"
						},
						"value": "BS"
					}
				]
			},
			"Use Card Again?": {
				"position": {
					"x": 1299.2,
					"y": -663.2
				},
				"isFriendlyName": true,
				"conditionMetadata": [
					{
						"id": "af4aed3f-1a0a-4172-b084-765c827d66e7",
						"value": "1"
					},
					{
						"id": "43ee4c62-082f-42d3-9ce0-f7e79cd3037f",
						"value": "2"
					}
				]
			},
			"b2786200-e897-45bd-b888-0f53246f72ed": {
				"position": {
					"x": -748.8,
					"y": 534.4
				}
			},
			"Record Payment Request ID": {
				"position": {
					"x": -1256.8,
					"y": 152.8
				},
				"isFriendlyName": true,
				"dynamicParams": []
			},
			"Create Payment Request": {
				"position": {
					"x": -1484,
					"y": 224
				},
				"isFriendlyName": true,
				"parameters": {
					"LambdaFunctionARN": {
						"displayName": "<<createPaymentRequestLambdaArn>>"
					}
				},
				"dynamicMetadata": {}
			},
			"Payment Request Error": {
				"position": {
					"x": -992,
					"y": 535.2
				},
				"isFriendlyName": true
			},
			"Store Routing Number": {
				"position": {
					"x": 4120,
					"y": 112
				},
				"isFriendlyName": true,
				"parameters": {
					"Attributes": {
						"RoutingNumber": {
							"useDynamic": true
						}
					}
				},
				"dynamicParams": ["RoutingNumber"]
			},
			"Store Expiration Date": {
				"position": {
					"x": 4127.2,
					"y": -695.2
				},
				"isFriendlyName": true,
				"parameters": {
					"Attributes": {
						"ExpirationDate": {
							"useDynamic": true
						}
					}
				},
				"dynamicParams": ["ExpirationDate"]
			},
			"Get Payment Amount": {
				"position": {
					"x": 60.8,
					"y": -46.4
				},
				"isFriendlyName": true,
				"conditionMetadata": [],
				"countryCodePrefix": "+1"
			},
			"Set Payment Amount to Entered Amount": {
				"position": {
					"x": 452,
					"y": -34.4
				},
				"isFriendlyName": true,
				"parameters": {
					"Attributes": {
						"PaymentAmount": {
							"useDynamic": true
						}
					}
				},
				"dynamicParams": ["PaymentAmount"]
			},
			"Set Payment Amount to Full Amount": {
				"position": {
					"x": 468,
					"y": 447.2
				},
				"isFriendlyName": true,
				"parameters": {
					"Attributes": {
						"PaymentAmount": {
							"useDynamic": true
						}
					}
				},
				"dynamicParams": ["PaymentAmount"]
			},
			"Method Input Not Recognized": {
				"position": {
					"x": 2427.2,
					"y": -340
				},
				"isFriendlyName": true
			},
			"Prompt for Payment Amount Choice": {
				"position": {
					"x": -479.2,
					"y": -38.4
				},
				"isFriendlyName": true,
				"conditionMetadata": [
					{
						"id": "ec15edb2-3cab-4868-9028-c2d4328bc422",
						"value": "1"
					},
					{
						"id": "784b8816-21ca-46ab-9a83-4d10baa92da3",
						"value": "2"
					}
				]
			},
			"Amount Choice Input Not Recognized": {
				"position": {
					"x": -416,
					"y": -337.6
				},
				"isFriendlyName": true
			},
			"Receipt Success": {
				"position": {
					"x": 6921.6,
					"y": -129.6
				},
				"isFriendlyName": true
			},
			"Email Receipt": {
				"position": {
					"x": 6702.4,
					"y": -43.2
				},
				"isFriendlyName": true,
				"parameters": {
					"LambdaFunctionARN": {
						"displayName": "<<emailReceiptLambdaArn>>"
					}
				},
				"dynamicMetadata": {}
			},
			"Redact Sensitive Contact Attributes": {
				"position": {
					"x": 7378.4,
					"y": 184
				},
				"isFriendlyName": true,
				"dynamicParams": []
			},
			"Receipt Error": {
				"position": {
					"x": 7143.2,
					"y": 55.2
				},
				"isFriendlyName": true
			},
			"Payment Submission Error": {
				"position": {
					"x": 6016,
					"y": 158.4
				},
				"isFriendlyName": true
			},
			"Remove Failed Payment Token": {
				"position": {
					"x": 6335.2,
					"y": 253.6
				},
				"isFriendlyName": true,
				"dynamicParams": []
			},
			"Payment Validation Error": {
				"position": {
					"x": 6020.8,
					"y": 337.6
				},
				"isFriendlyName": true
			},
			"Submit Payment": {
				"position": {
					"x": 5556,
					"y": -128.8
				},
				"isFriendlyName": true,
				"parameters": {
					"LambdaFunctionARN": {
						"displayName": "<<submitPaymentLambdaArn>>"
					}
				},
				"dynamicMetadata": {}
			},
			"Tokenize Transaction": {
				"position": {
					"x": 4880,
					"y": -132.8
				},
				"isFriendlyName": true,
				"parameters": {
					"LambdaFunctionARN": {
						"displayName": "<<tokenizeTransactionLambdaArn>>"
					}
				},
				"dynamicMetadata": {}
			},
			"Record Token": {
				"position": {
					"x": 5115.2,
					"y": -130.4
				},
				"isFriendlyName": true,
				"dynamicParams": []
			},
			"Ask for Payment Method": {
				"position": {
					"x": 2230.4,
					"y": -29.6
				},
				"isFriendlyName": true,
				"conditionMetadata": [
					{
						"id": "a6813bb7-649f-41c5-919c-e539894f0993",
						"value": "1"
					},
					{
						"id": "607b247d-62aa-4ef9-9d9d-d287b9a1e79b",
						"value": "2"
					}
				]
			},
			"Routing Number Timeout": {
				"position": {
					"x": 3752,
					"y": -92
				},
				"isFriendlyName": true
			},
			"Routing Number Timeout Check": {
				"position": {
					"x": 3996,
					"y": -147.2
				},
				"isFriendlyName": true,
				"conditions": [],
				"conditionMetadata": [
					{
						"id": "0f34306c-427b-4986-9e57-840d5db3c79b",
						"operator": {
							"name": "Equals",
							"value": "Equals",
							"shortDisplay": "="
						},
						"value": "Timeout"
					}
				]
			},
			"Store Encrypted Account Number": {
				"position": {
					"x": 3212.8,
					"y": 131.2
				},
				"isFriendlyName": true,
				"parameters": {
					"Attributes": {
						"EncryptedAccountNumber": {
							"useDynamic": true
						}
					}
				},
				"dynamicParams": ["EncryptedAccountNumber"]
			},
			"Try Routing Number Again": {
				"position": {
					"x": 3879.2,
					"y": 354.4
				},
				"isFriendlyName": true
			},
			"Get Routing Number": {
				"position": {
					"x": 3841.6,
					"y": 131.2
				},
				"isFriendlyName": true,
				"conditionMetadata": [],
				"countryCodePrefix": "+1"
			},
			"Account Number Timeout": {
				"position": {
					"x": 2944,
					"y": -92.8
				},
				"isFriendlyName": true
			},
			"Account Number Timeout Check": {
				"position": {
					"x": 3188.8,
					"y": -72.8
				},
				"isFriendlyName": true,
				"conditions": [],
				"conditionMetadata": [
					{
						"id": "e1c4fe13-b29b-4e27-8347-b7a1b28e4922",
						"operator": {
							"name": "Equals",
							"value": "Equals",
							"shortDisplay": "="
						},
						"value": "Timeout"
					}
				]
			},
			"Set Payment Method to Bank": {
				"position": {
					"x": 2748.8,
					"y": 111.2
				},
				"isFriendlyName": true,
				"dynamicParams": []
			},
			"Get & Encrypt Account Number": {
				"position": {
					"x": 2976,
					"y": 114.4
				},
				"isFriendlyName": true,
				"conditionMetadata": [],
				"countryCodePrefix": "+1"
			},
			"Card Number Timeout": {
				"position": {
					"x": 2892,
					"y": -1114.4
				},
				"isFriendlyName": true
			},
			"Set Payment Method to Card": {
				"position": {
					"x": 2674.4,
					"y": -698.4
				},
				"isFriendlyName": true,
				"dynamicParams": []
			},
			"Get & Encrypt Card Number": {
				"position": {
					"x": 2899.2,
					"y": -692.8
				},
				"isFriendlyName": true,
				"conditionMetadata": [],
				"countryCodePrefix": "+1"
			},
			"Expiration Date Timeout": {
				"position": {
					"x": 3833.6,
					"y": -1106.4
				},
				"isFriendlyName": true
			},
			"Expiration Date Timeout Check": {
				"position": {
					"x": 3968.8,
					"y": -901.6
				},
				"isFriendlyName": true,
				"conditions": [],
				"conditionMetadata": [
					{
						"id": "dded97e2-32d3-4c9b-933b-f2f500fdc414",
						"operator": {
							"name": "Equals",
							"value": "Equals",
							"shortDisplay": "="
						},
						"value": "Timeout"
					}
				]
			},
			"Try Expiration Date Again": {
				"position": {
					"x": 3928,
					"y": -489.6
				},
				"isFriendlyName": true
			},
			"Card Number Timeout Check": {
				"position": {
					"x": 3020.8,
					"y": -892
				},
				"isFriendlyName": true,
				"conditions": [],
				"conditionMetadata": [
					{
						"id": "a85b1eec-f702-4395-b831-8961f6bccd6a",
						"operator": {
							"name": "Equals",
							"value": "Equals",
							"shortDisplay": "="
						},
						"value": "Timeout"
					}
				]
			},
			"Internal Error": {
				"position": {
					"x": 2659.2,
					"y": 524
				},
				"isFriendlyName": true
			},
			"Get Expiration Date": {
				"position": {
					"x": 3865.6,
					"y": -704.8
				},
				"isFriendlyName": true,
				"conditionMetadata": [],
				"countryCodePrefix": "+1"
			},
			"Store Encrypted Card Number": {
				"position": {
					"x": 3148,
					"y": -687.2
				},
				"isFriendlyName": true,
				"parameters": {
					"Attributes": {
						"EncryptedCardNumber": {
							"useDynamic": true
						}
					}
				},
				"dynamicParams": ["EncryptedCardNumber"]
			}
		},
		"Annotations": [],
		"name": "C3 Payment IVR Flow Module",
		"description": "Flow module to collect payments through a self-service IVR using C3.",
		"status": "published",
		"hash": {}
	},
	"Actions": [
		{
			"Parameters": {
				"Text": "Your payment was processed successfully."
			},
			"Identifier": "Payment Success",
			"Type": "MessageParticipant",
			"Transitions": {
				"NextAction": "Check for Customer Email",
				"Errors": [
					{
						"NextAction": "Check for Customer Email",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Attributes": {
					"TransactionId": "$.External.TransactionId"
				},
				"TargetContact": "Current"
			},
			"Identifier": "Record Transaction ID",
			"Type": "UpdateContactAttributes",
			"Transitions": {
				"NextAction": "Payment Success",
				"Errors": [
					{
						"NextAction": "Payment Success",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Text": "A payment has been requested for the amount of $$.Attributes.PaymentAmountDue."
			},
			"Identifier": "Speak Amount",
			"Type": "MessageParticipant",
			"Transitions": {
				"NextAction": "Check for Minimum Payment",
				"Errors": [
					{
						"NextAction": "Check for Minimum Payment",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Text": "Are you still there?"
			},
			"Identifier": "Amount Choice Timeout",
			"Type": "MessageParticipant",
			"Transitions": {
				"NextAction": "Prompt for Payment Amount Choice",
				"Errors": [
					{
						"NextAction": "Prompt for Payment Amount Choice",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Text": "You are permitted to make a partial payment of at least $$.Attributes.PaymentMinimumPayment."
			},
			"Identifier": "Speak Minimum Payment",
			"Type": "MessageParticipant",
			"Transitions": {
				"NextAction": "Get Payment Amount",
				"Errors": [
					{
						"NextAction": "Get Payment Amount",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Text": "Are you still there?"
			},
			"Identifier": "Payment Amount Timeout",
			"Type": "MessageParticipant",
			"Transitions": {
				"NextAction": "Speak Minimum Payment",
				"Errors": [
					{
						"NextAction": "Speak Minimum Payment",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Text": "The entered amount of $$.StoredCustomerInput exceeds the total amount due of $$.Attributes.PaymentAmountDue. Please try again with a smaller amount."
			},
			"Identifier": "Payment Too Large",
			"Type": "MessageParticipant",
			"Transitions": {
				"NextAction": "Speak Minimum Payment",
				"Errors": [
					{
						"NextAction": "Speak Minimum Payment",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Text": "The entered amount of $$.StoredCustomerInput is less than the minimum payment of $$.Attributes.PaymentMinimumPayment. Please try again with a larger amount."
			},
			"Identifier": "Payment Too Small",
			"Type": "MessageParticipant",
			"Transitions": {
				"NextAction": "Speak Minimum Payment",
				"Errors": [
					{
						"NextAction": "Speak Minimum Payment",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"ComparisonValue": "$.StoredCustomerInput"
			},
			"Identifier": "Check Payment Amount",
			"Type": "Compare",
			"Transitions": {
				"NextAction": "Set Payment Amount to Entered Amount",
				"Conditions": [
					{
						"NextAction": "Payment Amount Timeout",
						"Condition": {
							"Operator": "Equals",
							"Operands": ["Timeout"]
						}
					},
					{
						"NextAction": "Payment Too Large",
						"Condition": {
							"Operator": "NumberGreaterThan",
							"Operands": ["$.Attributes.PaymentAmountDue"]
						}
					},
					{
						"NextAction": "Payment Too Small",
						"Condition": {
							"Operator": "NumberLessThan",
							"Operands": ["$.Attributes.PaymentMinimumPayment"]
						}
					}
				],
				"Errors": [
					{
						"NextAction": "Set Payment Amount to Entered Amount",
						"ErrorType": "NoMatchingCondition"
					}
				]
			}
		},
		{
			"Parameters": {
				"FlowLoggingBehavior": "Disabled"
			},
			"Identifier": "87859db2-400d-410b-8818-05c8ae4869aa",
			"Type": "UpdateFlowLoggingBehavior",
			"Transitions": {
				"NextAction": "Create Payment Request"
			}
		},
		{
			"Parameters": {},
			"Identifier": "a3ea896e-4f43-4677-8edd-159f677dc41e",
			"Type": "EndFlowModuleExecution",
			"Transitions": {}
		},
		{
			"Parameters": {
				"ComparisonValue": "$.Attributes.Email"
			},
			"Identifier": "Check for Customer Email",
			"Type": "Compare",
			"Transitions": {
				"NextAction": "Redact Sensitive Contact Attributes",
				"Conditions": [
					{
						"NextAction": "Email Receipt",
						"Condition": {
							"Operator": "TextContains",
							"Operands": ["@"]
						}
					}
				],
				"Errors": [
					{
						"NextAction": "Redact Sensitive Contact Attributes",
						"ErrorType": "NoMatchingCondition"
					}
				]
			}
		},
		{
			"Parameters": {
				"Text": "Are you still there?"
			},
			"Identifier": "Use Payment Method Again Timeout",
			"Type": "MessageParticipant",
			"Transitions": {
				"NextAction": "Check for Payment Token",
				"Errors": [
					{
						"NextAction": "Check for Payment Token",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Text": "Are you still there?"
			},
			"Identifier": "Payment Method Timeout",
			"Type": "MessageParticipant",
			"Transitions": {
				"NextAction": "Ask for Payment Method",
				"Errors": [
					{
						"NextAction": "Ask for Payment Method",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"StoreInput": "False",
				"InputTimeLimitSeconds": "5",
				"Text": "You previously paid with a bank account.\n\nIf you would like to use this account again for this payment, press 1.\nTo use a different payment method, press 2."
			},
			"Identifier": "Use Bank Account Again?",
			"Type": "GetParticipantInput",
			"Transitions": {
				"NextAction": "Ask for Payment Method",
				"Conditions": [
					{
						"NextAction": "Submit Payment",
						"Condition": {
							"Operator": "Equals",
							"Operands": ["1"]
						}
					},
					{
						"NextAction": "Ask for Payment Method",
						"Condition": {
							"Operator": "Equals",
							"Operands": ["2"]
						}
					}
				],
				"Errors": [
					{
						"NextAction": "Use Payment Method Again Timeout",
						"ErrorType": "InputTimeLimitExceeded"
					},
					{
						"NextAction": "Ask for Payment Method",
						"ErrorType": "NoMatchingCondition"
					},
					{
						"NextAction": "Ask for Payment Method",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"ComparisonValue": "$.Attributes.PaymentMinimumPayment"
			},
			"Identifier": "Check for Minimum Payment",
			"Type": "Compare",
			"Transitions": {
				"NextAction": "Ask for Payment Method",
				"Conditions": [
					{
						"NextAction": "Ask for Payment Method",
						"Condition": {
							"Operator": "Equals",
							"Operands": ["PaymentAmountDue"]
						}
					},
					{
						"NextAction": "Prompt for Payment Amount Choice",
						"Condition": {
							"Operator": "NumberGreaterThan",
							"Operands": ["0"]
						}
					}
				],
				"Errors": [
					{
						"NextAction": "Ask for Payment Method",
						"ErrorType": "NoMatchingCondition"
					}
				]
			}
		},
		{
			"Parameters": {
				"ComparisonValue": "$.Attributes.PaymentToken"
			},
			"Identifier": "Check for Payment Token",
			"Type": "Compare",
			"Transitions": {
				"NextAction": "Ask for Payment Method",
				"Conditions": [
					{
						"NextAction": "Use Card Again?",
						"Condition": {
							"Operator": "TextStartsWith",
							"Operands": ["VC"]
						}
					},
					{
						"NextAction": "Use Bank Account Again?",
						"Condition": {
							"Operator": "TextStartsWith",
							"Operands": ["BC"]
						}
					},
					{
						"NextAction": "Use Bank Account Again?",
						"Condition": {
							"Operator": "TextStartsWith",
							"Operands": ["BS"]
						}
					}
				],
				"Errors": [
					{
						"NextAction": "Ask for Payment Method",
						"ErrorType": "NoMatchingCondition"
					}
				]
			}
		},
		{
			"Parameters": {
				"StoreInput": "False",
				"InputTimeLimitSeconds": "5",
				"Text": "You previously paid with a credit or debit card.\n\nIf you would like to use this card again for this payment, press 1.\nTo use a different payment method, press 2."
			},
			"Identifier": "Use Card Again?",
			"Type": "GetParticipantInput",
			"Transitions": {
				"NextAction": "Ask for Payment Method",
				"Conditions": [
					{
						"NextAction": "Submit Payment",
						"Condition": {
							"Operator": "Equals",
							"Operands": ["1"]
						}
					},
					{
						"NextAction": "Ask for Payment Method",
						"Condition": {
							"Operator": "Equals",
							"Operands": ["2"]
						}
					}
				],
				"Errors": [
					{
						"NextAction": "Use Payment Method Again Timeout",
						"ErrorType": "InputTimeLimitExceeded"
					},
					{
						"NextAction": "Ask for Payment Method",
						"ErrorType": "NoMatchingCondition"
					},
					{
						"NextAction": "Ask for Payment Method",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {},
			"Identifier": "b2786200-e897-45bd-b888-0f53246f72ed",
			"Type": "EndFlowModuleExecution",
			"Transitions": {}
		},
		{
			"Parameters": {
				"Attributes": {
					"PaymentRequestId": "$.External.PaymentRequestId"
				},
				"TargetContact": "Current"
			},
			"Identifier": "Record Payment Request ID",
			"Type": "UpdateContactAttributes",
			"Transitions": {
				"NextAction": "Speak Amount",
				"Errors": [
					{
						"NextAction": "Payment Request Error",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"LambdaFunctionARN": "<<createPaymentRequestLambdaArn>>",
				"InvocationTimeLimitSeconds": "8",
				"ResponseValidation": {
					"ResponseType": "JSON"
				}
			},
			"Identifier": "Create Payment Request",
			"Type": "InvokeLambdaFunction",
			"Transitions": {
				"NextAction": "Record Payment Request ID",
				"Errors": [
					{
						"NextAction": "Payment Request Error",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Text": "There was an error creating the payment request."
			},
			"Identifier": "Payment Request Error",
			"Type": "MessageParticipant",
			"Transitions": {
				"NextAction": "b2786200-e897-45bd-b888-0f53246f72ed",
				"Errors": [
					{
						"NextAction": "b2786200-e897-45bd-b888-0f53246f72ed",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Attributes": {
					"RoutingNumber": "$.StoredCustomerInput"
				},
				"TargetContact": "Current"
			},
			"Identifier": "Store Routing Number",
			"Type": "UpdateContactAttributes",
			"Transitions": {
				"NextAction": "Tokenize Transaction",
				"Errors": [
					{
						"NextAction": "Internal Error",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Attributes": {
					"ExpirationDate": "$.StoredCustomerInput"
				},
				"TargetContact": "Current"
			},
			"Identifier": "Store Expiration Date",
			"Type": "UpdateContactAttributes",
			"Transitions": {
				"NextAction": "Tokenize Transaction",
				"Errors": [
					{
						"NextAction": "Internal Error",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"StoreInput": "True",
				"InputTimeLimitSeconds": "5",
				"Text": "Please enter the amount you would like to pay in whole dollars, followed by the pound key.",
				"DTMFConfiguration": {
					"DisableCancelKey": "False",
					"InputTerminationSequence": "#"
				},
				"InputValidation": {
					"CustomValidation": {
						"MaximumLength": "20"
					}
				}
			},
			"Identifier": "Get Payment Amount",
			"Type": "GetParticipantInput",
			"Transitions": {
				"NextAction": "Check Payment Amount",
				"Errors": [
					{
						"NextAction": "Internal Error",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Attributes": {
					"PaymentAmount": "$.StoredCustomerInput"
				},
				"TargetContact": "Current"
			},
			"Identifier": "Set Payment Amount to Entered Amount",
			"Type": "UpdateContactAttributes",
			"Transitions": {
				"NextAction": "Check for Payment Token",
				"Errors": [
					{
						"NextAction": "Internal Error",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Attributes": {
					"PaymentAmount": "$.Customer.Attributes.PaymentAmountDue"
				},
				"TargetContact": "Current"
			},
			"Identifier": "Set Payment Amount to Full Amount",
			"Type": "UpdateContactAttributes",
			"Transitions": {
				"NextAction": "Check for Payment Token",
				"Errors": [
					{
						"NextAction": "Internal Error",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Text": "Your entry was not recognized. Please try again."
			},
			"Identifier": "Method Input Not Recognized",
			"Type": "MessageParticipant",
			"Transitions": {
				"NextAction": "Ask for Payment Method",
				"Errors": [
					{
						"NextAction": "Ask for Payment Method",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"StoreInput": "False",
				"InputTimeLimitSeconds": "5",
				"Text": "To pay the amount in full, press 1.\nTo pay a partial amount, press 2."
			},
			"Identifier": "Prompt for Payment Amount Choice",
			"Type": "GetParticipantInput",
			"Transitions": {
				"NextAction": "Amount Choice Input Not Recognized",
				"Conditions": [
					{
						"NextAction": "Set Payment Amount to Full Amount",
						"Condition": {
							"Operator": "Equals",
							"Operands": ["1"]
						}
					},
					{
						"NextAction": "Speak Minimum Payment",
						"Condition": {
							"Operator": "Equals",
							"Operands": ["2"]
						}
					}
				],
				"Errors": [
					{
						"NextAction": "Amount Choice Timeout",
						"ErrorType": "InputTimeLimitExceeded"
					},
					{
						"NextAction": "Amount Choice Input Not Recognized",
						"ErrorType": "NoMatchingCondition"
					},
					{
						"NextAction": "Amount Choice Input Not Recognized",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Text": "Your entry was not recognized. Please try again."
			},
			"Identifier": "Amount Choice Input Not Recognized",
			"Type": "MessageParticipant",
			"Transitions": {
				"NextAction": "Prompt for Payment Amount Choice",
				"Errors": [
					{
						"NextAction": "Prompt for Payment Amount Choice",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Text": "A receipt has been sent to your email address, $.Attributes.['Email']."
			},
			"Identifier": "Receipt Success",
			"Type": "MessageParticipant",
			"Transitions": {
				"NextAction": "Redact Sensitive Contact Attributes",
				"Errors": [
					{
						"NextAction": "Redact Sensitive Contact Attributes",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"LambdaFunctionARN": "<<emailReceiptLambdaArn>>",
				"InvocationTimeLimitSeconds": "8",
				"ResponseValidation": {
					"ResponseType": "JSON"
				}
			},
			"Identifier": "Email Receipt",
			"Type": "InvokeLambdaFunction",
			"Transitions": {
				"NextAction": "Receipt Success",
				"Errors": [
					{
						"NextAction": "Receipt Error",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Attributes": {
					"EncryptedCardNumber": "REDACTED",
					"EncryptedAccountNumber": "REDACTED",
					"ExpirationDate": "REDACTED"
				},
				"TargetContact": "Current"
			},
			"Identifier": "Redact Sensitive Contact Attributes",
			"Type": "UpdateContactAttributes",
			"Transitions": {
				"NextAction": "a3ea896e-4f43-4677-8edd-159f677dc41e",
				"Errors": [
					{
						"NextAction": "a3ea896e-4f43-4677-8edd-159f677dc41e",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Text": "There was an error sending the receipt to your email address, $.Attributes.['Email']. Please contact customer support to receive a receipt for this transaction."
			},
			"Identifier": "Receipt Error",
			"Type": "MessageParticipant",
			"Transitions": {
				"NextAction": "Redact Sensitive Contact Attributes",
				"Errors": [
					{
						"NextAction": "Redact Sensitive Contact Attributes",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Text": "We're sorry, an error has occured preventing us from submitting your payment. You have not been charged."
			},
			"Identifier": "Payment Submission Error",
			"Type": "MessageParticipant",
			"Transitions": {
				"NextAction": "Remove Failed Payment Token",
				"Errors": [
					{
						"NextAction": "Remove Failed Payment Token",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Attributes": {
					"PaymentToken": " "
				},
				"TargetContact": "Current"
			},
			"Identifier": "Remove Failed Payment Token",
			"Type": "UpdateContactAttributes",
			"Transitions": {
				"NextAction": "Redact Sensitive Contact Attributes",
				"Errors": [
					{
						"NextAction": "Redact Sensitive Contact Attributes",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Text": "There was a problem validating your $.Attributes.PaymentMethod information."
			},
			"Identifier": "Payment Validation Error",
			"Type": "MessageParticipant",
			"Transitions": {
				"NextAction": "Remove Failed Payment Token",
				"Errors": [
					{
						"NextAction": "Remove Failed Payment Token",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"LambdaFunctionARN": "<<submitPaymentLambdaArn>>",
				"InvocationTimeLimitSeconds": "8",
				"ResponseValidation": {
					"ResponseType": "JSON"
				}
			},
			"Identifier": "Submit Payment",
			"Type": "InvokeLambdaFunction",
			"Transitions": {
				"NextAction": "Record Transaction ID",
				"Errors": [
					{
						"NextAction": "Payment Submission Error",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"LambdaFunctionARN": "<<tokenizeTransactionLambdaArn>>",
				"InvocationTimeLimitSeconds": "8",
				"ResponseValidation": {
					"ResponseType": "JSON"
				}
			},
			"Identifier": "Tokenize Transaction",
			"Type": "InvokeLambdaFunction",
			"Transitions": {
				"NextAction": "Record Token",
				"Errors": [
					{
						"NextAction": "Payment Validation Error",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Attributes": {
					"PaymentToken": "$.External.PaymentToken"
				},
				"TargetContact": "Current"
			},
			"Identifier": "Record Token",
			"Type": "UpdateContactAttributes",
			"Transitions": {
				"NextAction": "Submit Payment",
				"Errors": [
					{
						"NextAction": "Submit Payment",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"StoreInput": "False",
				"InputTimeLimitSeconds": "5",
				"Text": "To pay with a credit or debit card, press 1.\nTo pay directly with your bank account, press 2."
			},
			"Identifier": "Ask for Payment Method",
			"Type": "GetParticipantInput",
			"Transitions": {
				"NextAction": "Method Input Not Recognized",
				"Conditions": [
					{
						"NextAction": "Set Payment Method to Card",
						"Condition": {
							"Operator": "Equals",
							"Operands": ["1"]
						}
					},
					{
						"NextAction": "Set Payment Method to Bank",
						"Condition": {
							"Operator": "Equals",
							"Operands": ["2"]
						}
					}
				],
				"Errors": [
					{
						"NextAction": "Payment Method Timeout",
						"ErrorType": "InputTimeLimitExceeded"
					},
					{
						"NextAction": "Method Input Not Recognized",
						"ErrorType": "NoMatchingCondition"
					},
					{
						"NextAction": "Method Input Not Recognized",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Text": "Are you still there?"
			},
			"Identifier": "Routing Number Timeout",
			"Type": "MessageParticipant",
			"Transitions": {
				"NextAction": "Get Routing Number",
				"Errors": [
					{
						"NextAction": "Get Routing Number",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"ComparisonValue": "$.StoredCustomerInput"
			},
			"Identifier": "Routing Number Timeout Check",
			"Type": "Compare",
			"Transitions": {
				"NextAction": "Store Routing Number",
				"Conditions": [
					{
						"NextAction": "Routing Number Timeout",
						"Condition": {
							"Operator": "Equals",
							"Operands": ["Timeout"]
						}
					}
				],
				"Errors": [
					{
						"NextAction": "Store Routing Number",
						"ErrorType": "NoMatchingCondition"
					}
				]
			}
		},
		{
			"Parameters": {
				"Attributes": {
					"EncryptedAccountNumber": "$.StoredCustomerInput"
				},
				"TargetContact": "Current"
			},
			"Identifier": "Store Encrypted Account Number",
			"Type": "UpdateContactAttributes",
			"Transitions": {
				"NextAction": "Get Routing Number",
				"Errors": [
					{
						"NextAction": "Internal Error",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Text": "There was a problem with your bank routing number. Please check your entry and try again."
			},
			"Identifier": "Try Routing Number Again",
			"Type": "MessageParticipant",
			"Transitions": {
				"NextAction": "Get Routing Number",
				"Errors": [
					{
						"NextAction": "Get Routing Number",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"StoreInput": "True",
				"InputTimeLimitSeconds": "10",
				"Text": "Please enter your bank's routing number, followed by the pound key when complete.",
				"DTMFConfiguration": {
					"DisableCancelKey": "False",
					"InputTerminationSequence": "#"
				},
				"InputValidation": {
					"CustomValidation": {
						"MaximumLength": "25"
					}
				}
			},
			"Identifier": "Get Routing Number",
			"Type": "GetParticipantInput",
			"Transitions": {
				"NextAction": "Routing Number Timeout Check",
				"Errors": [
					{
						"NextAction": "Try Routing Number Again",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Text": "Are you still there?"
			},
			"Identifier": "Account Number Timeout",
			"Type": "MessageParticipant",
			"Transitions": {
				"NextAction": "Get & Encrypt Account Number",
				"Errors": [
					{
						"NextAction": "Get & Encrypt Account Number",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"ComparisonValue": "$.StoredCustomerInput"
			},
			"Identifier": "Account Number Timeout Check",
			"Type": "Compare",
			"Transitions": {
				"NextAction": "Store Encrypted Account Number",
				"Conditions": [
					{
						"NextAction": "Account Number Timeout",
						"Condition": {
							"Operator": "Equals",
							"Operands": ["Timeout"]
						}
					}
				],
				"Errors": [
					{
						"NextAction": "Store Encrypted Account Number",
						"ErrorType": "NoMatchingCondition"
					}
				]
			}
		},
		{
			"Parameters": {
				"Attributes": {
					"PaymentMethod": "Bank"
				},
				"TargetContact": "Current"
			},
			"Identifier": "Set Payment Method to Bank",
			"Type": "UpdateContactAttributes",
			"Transitions": {
				"NextAction": "Get & Encrypt Account Number",
				"Errors": [
					{
						"NextAction": "Get & Encrypt Account Number",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"StoreInput": "True",
				"InputTimeLimitSeconds": "10",
				"Text": "Please enter your bank account number followed by the pound key when complete.",
				"DTMFConfiguration": {
					"DisableCancelKey": "False",
					"InputTerminationSequence": "#"
				},
				"InputValidation": {
					"CustomValidation": {
						"MaximumLength": "25"
					}
				},
				"InputEncryption": {
					"EncryptionKeyId": "<<amazonConnectSecurityKeyId>>",
					"Key": "<<amazonConnectSecurityKeyCertificateContent>>"
				}
			},
			"Identifier": "Get & Encrypt Account Number",
			"Type": "GetParticipantInput",
			"Transitions": {
				"NextAction": "Account Number Timeout Check",
				"Errors": [
					{
						"NextAction": "Internal Error",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Text": "Are you still there?"
			},
			"Identifier": "Card Number Timeout",
			"Type": "MessageParticipant",
			"Transitions": {
				"NextAction": "Get & Encrypt Card Number",
				"Errors": [
					{
						"NextAction": "Get & Encrypt Card Number",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Attributes": {
					"PaymentMethod": "Card"
				},
				"TargetContact": "Current"
			},
			"Identifier": "Set Payment Method to Card",
			"Type": "UpdateContactAttributes",
			"Transitions": {
				"NextAction": "Get & Encrypt Card Number",
				"Errors": [
					{
						"NextAction": "Get & Encrypt Card Number",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"StoreInput": "True",
				"InputTimeLimitSeconds": "10",
				"Text": "Please enter your card number followed by the pound key when complete.",
				"DTMFConfiguration": {
					"DisableCancelKey": "False",
					"InputTerminationSequence": "#"
				},
				"InputValidation": {
					"CustomValidation": {
						"MaximumLength": "25"
					}
				},
				"InputEncryption": {
					"EncryptionKeyId": "<<amazonConnectSecurityKeyId>>",
					"Key": "<<amazonConnectSecurityKeyCertificateContent>>"
				}
			},
			"Identifier": "Get & Encrypt Card Number",
			"Type": "GetParticipantInput",
			"Transitions": {
				"NextAction": "Card Number Timeout Check",
				"Errors": [
					{
						"NextAction": "Internal Error",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Text": "Are you still there?"
			},
			"Identifier": "Expiration Date Timeout",
			"Type": "MessageParticipant",
			"Transitions": {
				"NextAction": "Get Expiration Date",
				"Errors": [
					{
						"NextAction": "Get Expiration Date",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"ComparisonValue": "$.StoredCustomerInput"
			},
			"Identifier": "Expiration Date Timeout Check",
			"Type": "Compare",
			"Transitions": {
				"NextAction": "Store Expiration Date",
				"Conditions": [
					{
						"NextAction": "Expiration Date Timeout",
						"Condition": {
							"Operator": "Equals",
							"Operands": ["Timeout"]
						}
					}
				],
				"Errors": [
					{
						"NextAction": "Store Expiration Date",
						"ErrorType": "NoMatchingCondition"
					}
				]
			}
		},
		{
			"Parameters": {
				"Text": "There was a problem with your expiration date. Please check your entry and try again."
			},
			"Identifier": "Try Expiration Date Again",
			"Type": "MessageParticipant",
			"Transitions": {
				"NextAction": "Get Expiration Date",
				"Errors": [
					{
						"NextAction": "Get Expiration Date",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"ComparisonValue": "$.StoredCustomerInput"
			},
			"Identifier": "Card Number Timeout Check",
			"Type": "Compare",
			"Transitions": {
				"NextAction": "Store Encrypted Card Number",
				"Conditions": [
					{
						"NextAction": "Card Number Timeout",
						"Condition": {
							"Operator": "Equals",
							"Operands": ["Timeout"]
						}
					}
				],
				"Errors": [
					{
						"NextAction": "Store Encrypted Card Number",
						"ErrorType": "NoMatchingCondition"
					}
				]
			}
		},
		{
			"Parameters": {
				"Text": "We're sorry, an error has occurred that prevents us from collecting the payment."
			},
			"Identifier": "Internal Error",
			"Type": "MessageParticipant",
			"Transitions": {
				"NextAction": "Redact Sensitive Contact Attributes",
				"Errors": [
					{
						"NextAction": "Redact Sensitive Contact Attributes",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"StoreInput": "True",
				"InputTimeLimitSeconds": "5",
				"Text": "Please enter your card's expiration date in the format month-month-year-year, followed by the pound key when complete.",
				"DTMFConfiguration": {
					"DisableCancelKey": "False",
					"InputTerminationSequence": "#"
				},
				"InputValidation": {
					"CustomValidation": {
						"MaximumLength": "25"
					}
				}
			},
			"Identifier": "Get Expiration Date",
			"Type": "GetParticipantInput",
			"Transitions": {
				"NextAction": "Expiration Date Timeout Check",
				"Errors": [
					{
						"NextAction": "Try Expiration Date Again",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		},
		{
			"Parameters": {
				"Attributes": {
					"EncryptedCardNumber": "$.StoredCustomerInput"
				},
				"TargetContact": "Current"
			},
			"Identifier": "Store Encrypted Card Number",
			"Type": "UpdateContactAttributes",
			"Transitions": {
				"NextAction": "Get Expiration Date",
				"Errors": [
					{
						"NextAction": "Internal Error",
						"ErrorType": "NoMatchingError"
					}
				]
			}
		}
	],
	"Settings": {
		"InputParameters": [],
		"OutputParameters": [],
		"Transitions": [
			{
				"DisplayName": "Success",
				"ReferenceName": "Success",
				"Description": ""
			},
			{
				"DisplayName": "Error",
				"ReferenceName": "Error",
				"Description": ""
			}
		]
	}
}
